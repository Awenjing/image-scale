/*! image-scale v1.3 | Â©2012-2013 Nicolas BADIA | Licensed under the MIT license */
!function(e){e.fn.imageScale=function(b){return this.each(function(){var l=e(this),a=l.data("imageScale");if(!a){l.css("opacity",0);var d=l[0].complete,f=e.extend({},e.fn.imageScale.defaults,"object"==typeof b&&b),g=function(){l.data("imageScale",a=new m(this,f));f.rescaleOnResize&&(window.requestAnimationFrame||e(window).resize(function(b){a.scale()}));a.scale(!0);var b=f.callback;"function"===typeof b?b(l,a):b&&"object"===typeof b&&b.target[b.action].apply(b.target,[l,a])};d?g.apply(l[0]):l.load(g)}else if("string"==
typeof b)a[b]()})};e.fn.imageScale.defaults={scale:"best-fill",align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:0,rescaleOnResize:!0,callback:null,debug:0};var m=function(b,l){this.options=l;this.element=b;var a=this.$element=e(b);this.elementWidth=a.attr("width")||b.width;this.elementHeight=a.attr("height")||b.height;this.$parent=l.parent?l.parent:e(e(b).parent()[0])};e.fn.imageScale.Constructor=m;m.prototype={NONE:"none",FILL:"fill",BEST_FILL:"best-fill",BEST_FIT:"best-fit",BEST_FIT_DOWN_ONLY:"best-fit-down",
ALIGN_LEFT:"left",ALIGN_RIGHT:"right",ALIGN_CENTER:"center",ALIGN_TOP:"top",ALIGN_BOTTOM:"bottom",ALIGN_TOP_LEFT:"top-left",ALIGN_TOP_RIGHT:"top-right",ALIGN_BOTTOM_LEFT:"bottom-left",ALIGN_BOTTOM_RIGHT:"bottom-right",constructor:m,scale:function(b){if(!this._isDestroyed){var l=this,a=this.options,d=this.$parent,f=this.element,g=this.$element;b&&(a.hideParentOverflow&&d.css({overflow:"hidden"}),g.css({opacity:1}));if(a.rescaleOnResize&&(window.requestAnimationFrame&&requestAnimationFrame(function(){l.scale()}),
!this._needUpdate()))return;var k=d.outerWidth(),h=d.outerHeight(),c=d.innerWidth(),d=d.innerHeight(),c=k-c,d=h-d,e=g.attr("data-scale"),n=g.attr("data-align"),e=e?e:a.scale,m=n?n:a.align,n=a.fadeInDuration;if(e){this._cacheDestWidth===k&&this._cacheDestHeight===h&&2<a.debug&&console.log("imageScale - DEBUG NOTICE: The parent size hasn't changed: dest width: '"+k+"' - dest height: '"+h+"'.");var p=this.elementWidth=this.elementWidth||f.width,f=this.elementHeight=this.elementHeight||f.height;k&&h&&
p&&f?(this._cacheDestWidth=k,this._cacheDestHeight=h,a=this._innerFrameForSize(e,m,p,f,k,h),c&&(a.x-=c/2),d&&(a.y-=d/2),g.css({position:"absolute",top:a.y+"px",left:a.x+"px",width:a.width+"px",height:a.height+"px","max-width":"none"}),b&&n&&(g.css({display:"none"}),g.fadeIn(n))):0<a.debug&&console.error("imageScale - DEBUG ERROR: The dimensions are incorrect: source width: '"+p+"' - source height: '"+f+"' - dest width: '"+k+"' - dest height: '"+h+"'.")}else 2<a.debug&&console.log("imageScale - DEBUG NOTICE: The scale property is null.")}},
destroy:function(){this._isDestroyed=!0;this.$element.removeData("imageScale")},_innerFrameForSize:function(b,e,a,d,f,g){var k,h,c;c={x:0,y:0,width:f,height:g};if(b===this.FILL)return c;k=f/a;h=g/d;switch(b){case this.BEST_FILL:b=k>h?k:h;break;case this.BEST_FIT:b=k<h?k:h;break;case this.NONE:b=1;break;default:b!==this.BEST_FIT_DOWN_ONLY&&1<this.options.debug&&console.warn("imageScale - DEBUG WARNING: The scale '"+b+"' was not understood."),b=a>f||d>g?k<h?k:h:1}a*=b;d*=b;c.width=Math.round(a);c.height=
Math.round(d);switch(e){case this.ALIGN_LEFT:c.x=0;c.y=g/2-d/2;break;case this.ALIGN_RIGHT:c.x=f-a;c.y=g/2-d/2;break;case this.ALIGN_TOP:c.x=f/2-a/2;c.y=0;break;case this.ALIGN_BOTTOM:c.x=f/2-a/2;c.y=g-d;break;case this.ALIGN_TOP_LEFT:c.x=0;c.y=0;break;case this.ALIGN_TOP_RIGHT:c.x=f-a;c.y=0;break;case this.ALIGN_BOTTOM_LEFT:c.x=0;c.y=g-d;break;case this.ALIGN_BOTTOM_RIGHT:c.x=f-a;c.y=g-d;break;default:e!==this.ALIGN_CENTER&&1<this.options.debug&&console.warn("imageScale - DEBUG WARNING: The align '"+
e+"' was not understood."),c.x=f/2-a/2,c.y=g/2-d/2}return c},_needUpdate:function(){var b=e(window).height()+" "+e(window).width();return this._lastWindowSize!==b?(this._lastWindowSize=b,!0):!1},_cacheDestWidth:null,_cacheDestHeight:null,_lastWindowSize:null}}(window.jQuery);